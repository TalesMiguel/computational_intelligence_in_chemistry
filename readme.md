# Hands-on: molecular data reading

## [Datasets](http://quantum-machine.org/datasets/)

### QM9 Database
- about 134k molecules

## Hands-on: molecular data reading

• Using a Colab notebook, create functions for:
1. Load and unpack the QM9 dataset
2. Open XYZ files and extract the properties and SMILES (and other features you find relevant for the tasks below)
   1. SMILES must be validated using the RDKit, invalid SMILES must be ignored
   2. Generate the canonical SMILES (which must be saved)
3. Create a dataframe (pandas) to store the QM9 samples (SMILES and properties)
4. Plotting histograms for all properties
5. Plotting histograms for the molecular composition and size
6. Correlation analysis considering: all properties, number of atoms, and molecular weight


• To consider:
   1. Open the original QM9 file available at http://quantum-machine.org/datasets/
   2. Write your own function to load the samples and get the data
   3. Deadline: 22/09/2025


#### Citating the QM9 dataset
- When using this dataset, please make sure to cite the following two papers:

    - L. Ruddigkeit, R. van Deursen, L. C. Blum, J.-L. Reymond, Enumeration of 166 billion organic small molecules in the chemical universe database GDB-17, J. Chem. Inf. Model. 52, 2864–2875, 2012.

    - R. Ramakrishnan, P. O. Dral, M. Rupp, O. A. von Lilienfeld, Quantum chemistry structures and properties of 134 kilo molecules, Scientific Data 1, 140022, 2014. [bibtex]


### Annotations

#### General Structure of QM9 XYZ Files
- Line 1: Number of atoms in the molecule

- Line 2: Extended header with computed molecular properties (16 values):
    1. gdb ID - Database identifier
    2. A - Rotational constant A (GHz)
    3. B - Rotational constant B (GHz)
    4. C - Rotational constant C (GHz)
    5. μ - Dipole moment (Debye)
    6. α - Isotropic polarizability (Bohr³)
    7. εHOMO - Energy of Highest Occupied Molecular Orbital (Hartree)
    8. εLUMO - Energy of Lowest Unoccupied Molecular Orbital (Hartree)
    9. Δε - Gap between HOMO and LUMO (Hartree)
    10. 〈R²〉 - Electronic spatial extent (Bohr²)
    11. zpve - Zero point vibrational energy (Hartree)
    12. U₀ - Internal energy at 0K (Hartree)
    13. U - Internal energy at 298.15K (Hartree)
    14. H - Enthalpy at 298.15K (Hartree)
    15. G - Free energy at 298.15K (Hartree)
    16. Cv - Heat capacity at 298.15K (cal/mol·K)

- Lines 3 to N+2: Atomic coordinates and charges (5 columns):
    1. Element symbol - Chemical element (C, H, N, O, etc.)
    2. x coordinate - Position in Angstroms
    3. y coordinate - Position in Angstroms
    4. z coordinate - Position in Angstroms
    5. Partial charge - Mulliken partial charge (electrons)
    
- Line N+3: Harmonic vibrational frequencies (cm⁻¹) - varies by molecule size

- Line N+4: Mulliken charges by atom type

- Lines N+5 & N+6: InChI strings for chemical identification and verification

This format is specifically from the QM9 quantum chemistry dataset, which contains computed properties for ~134k small organic molecules calculated using density functional theory (DFT).


#### Claude Sonnet 4 interpretation of the first .xyz file
This appears to be a molecular structure file in XYZ format, which is a common format used in computational chemistry and molecular modeling. The file describes a methane molecule (CH₄) with detailed quantum mechanical properties.

The first line contains the number "5", indicating there are 5 atoms in the molecule. The second line is a header containing various computed properties from quantum mechanical calculations, including energies, molecular properties, and other descriptors. The values like "-40.47893" appear to be energies in Hartree units (atomic units of energy), while other numbers represent properties like molecular weight, polarizability, and various energy corrections.

The next five lines describe the atomic coordinates and properties. Each line starts with an element symbol (C for carbon, H for hydrogen), followed by three coordinates (x, y, z) in Angstroms that define the atom's position in 3D space, and then a partial charge value. The carbon atom is positioned near the origin, while the four hydrogen atoms are arranged around it in a tetrahedral geometry, which is the expected shape for methane.

The subsequent lines contain additional molecular data. The series of numbers (1341.307, 1341.3284, etc.) likely represent vibrational frequencies in wavenumbers (cm⁻¹), which describe how the molecule vibrates. The final lines show connectivity information and InChI identifiers, which are standardized chemical structure representations that confirm this molecule is methane (CH₄).

This type of file is typically generated by quantum chemistry software packages and is used for storing and exchanging molecular structure and property data between different computational chemistry programs.
